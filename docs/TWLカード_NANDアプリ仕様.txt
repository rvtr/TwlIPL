TWLカード/NANDアプリ仕様


カードアプリ
　・NTR専用／TWL対応／TWL専用アプリ形式をサポート


NANDアプリ
　・TWL対応／TWL専用アプリ形式をサポート。
　　特例としてPictoChatとDSダウンロードプレイのみDSモードNANDアプリとなる可能性あり。
　　→NTR専用を完全サポートした場合の追加作業
　　　NTR-SRLファイルのフォーマット変更。（署名付加・一部領域暗号化。NTR本体での動作は非サポートにしないと一部領域暗号化は対応困難。）
　　　makeromの上記フォーマット対応。
　　　ランチャーの上記フォーマットブート対応。
　　　NTRモードブート時にI2C機能を有効にする必要あり。（HWリセット機能を使用。ランチャーへの復帰および下記のパラメータ付きアプリ切り替えを実現するために必要。）
　　　SDKにおいて現状TWLモード時にしか使えないI2C関係のライブラリをNTRモードでも使用できるようにする。

　※本体機能検討会でちゃぶ台返しされそう。。。


TitleID
　・NTR専用アプリには付加されない。
　・TWL対応／TWL専用アプリには、カード／NANDアプリに関係なく付加する。


NANDへのデータセーブ
　・NANDにセーブデータを保存できるのは、NANDアプリのみ。
　　カードアプリはNANDにセーブ不可。
　　→カードアプリ対応した場合の追加作業
　　　ランチャーで初回起動時にフォルダ＆ファイルを作成する必要がある。（ファームアップデートでの後付けはNG）
　　　アプリ管理画面でセーブファイルしかないものを「アプリ」として認識してNAND⇔SD処理をしなければならない。
　・セーブデータは、SDにコピー可能なPublicSaveDataとコピー不可のPrivateSaveDataがある。
　　PublicSaveData サイズ：16KB, 32KB, 64KB, 128KB, 256KB, 512KB, 1MB, 2MB, 4MB, 8MB
　　PrivateSaveDataサイズ：16KB固定


セーブバナーファイル
　NANDアプリのみ使用可能。カードアプリは不可。


パラメータ付きアプリ呼び出し
　TitleIDを起動対象アプリ識別に使用

　＜呼び出し組み合わせ＞
　NAND　 　アプリ　→　NAND　   アプリ		○
　NAND　 　アプリ　→　TWLカードアプリ		○
　NAND　 　アプリ　→　NTRカードアプリ		×（NTRカードアプリにはTitleIDがないので、ランチャーでは実現できる仕組みは実装しておくが、基本方針としては×にしておく）
　TWLカードアプリ　→　NAND　   アプリ		○
　NTRカードアプリ　→　NAND　   アプリ		×
　ANYカードアプリ　→　ANYカードアプリ		×（スロット１つなので）

　＜呼び出し種別＞
　未ロード状態からの起動
　オンメモリ状態での起動（再配置なし限定）
　呼び出し後の元アプリ復帰も可能（完全な中断→再開はできない）


ゲームカード活線挿抜
　ランチャーのみ可能。アプリでは禁止。

　※本体機能検討会でちゃぶ台返しされそう。。。


NANDアプリ起動時のカードの電源状態
　電源ON状態。
　セキュリティの都合上、起動前にランチャーがカード電源OFF→ONして、カードのステートをNORMALステートにしておく。（数十msかかる）
　ランチャーがアプリ起動前にARM7側のSCFGレジスタはロックしておく？


NANDアプリからのカードアクセス可能領域
　ROMヘッダ
　バックアップ領域
　NORMAL領域（TWLカードの時のみ）


